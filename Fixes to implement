Looking at your EcoLens code, I can identify several issues with the CSV/JSON import functionality. The main problems are:

1. Event listeners for import buttons aren't properly attached
2. File reading logic has conflicts
3. Preview sections aren't showing correctly

Here's the complete fix for your import functionality:

Replace the setupEventListeners() function with this corrected version:

```javascript
// Setup all event listeners - FIXED: Photo removal AND import functionality
setupEventListeners() {
    // Tab navigation
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
            e.preventDefault();
            const tab = btn.dataset.tab;
            this.switchTab(tab);
        });
    });

    // Set current date/time
    const setNowBtn = document.getElementById('set-now');
    if (setNowBtn) {
        setNowBtn.addEventListener('click', () => {
            this.setCurrentDateTime();
        });
    }

    // Record observation
    const recordBtn = document.getElementById('record-btn');
    if (recordBtn) {
        recordBtn.addEventListener('click', () => {
            this.handleRecordObservation();
        });
    }

    // Map controls
    const toggleMapBtn = document.getElementById('toggle-map');
    if (toggleMapBtn) {
        toggleMapBtn.addEventListener('click', () => {
            this.toggleMap();
        });
    }

    const useMyLocationBtn = document.getElementById('use-my-location');
    if (useMyLocationBtn) {
        useMyLocationBtn.addEventListener('click', () => {
            this.getUserLocation();
        });
    }

    // Photo handling - SIMPLIFIED FIX
    const photoRemoveBtn = document.getElementById('photo-remove');
    if (photoRemoveBtn) {
        // Add click event to the remove button
        photoRemoveBtn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            this.removePhoto();
        });
    }

    // Capture button handler
    const capturePhotoBtn = document.getElementById('capture-photo');
    if (capturePhotoBtn) {
        capturePhotoBtn.addEventListener('click', () => {
            document.getElementById('photo-upload').click();
        });
    }

    // File upload handler
    const photoUpload = document.getElementById('photo-upload');
    if (photoUpload) {
        photoUpload.addEventListener('change', (e) => {
            this.handlePhotoUpload(e);
        });
    }

    // Equipment checkboxes
    document.querySelectorAll('input[name="equipment"]').forEach(checkbox => {
        checkbox.addEventListener('change', (e) => {
            if (e.target.value === 'other-equipment') {
                const otherEquipment = document.getElementById('other-equipment');
                if (otherEquipment) {
                    otherEquipment.style.display = e.target.checked ? 'block' : 'none';
                    if (e.target.checked) {
                        otherEquipment.focus();
                    }
                }
            }
        });
    });

    // Export handling
    const generateExportBtn = document.getElementById('generate-export');
    if (generateExportBtn) {
        generateExportBtn.addEventListener('click', () => {
            this.handleExport();
        });
    }

    // Export format radio buttons
    const exportRadios = document.querySelectorAll('input[name="export-format"]');
    exportRadios.forEach(radio => {
        radio.addEventListener('change', (e) => {
            if (e.target.checked) {
                this.updateExportOptions(e.target.value);
            }
        });
    });

    // CSV import handlers - FIXED
    const previewImportBtn = document.getElementById('preview-import');
    if (previewImportBtn) {
        previewImportBtn.addEventListener('click', () => {
            this.handlePreviewCSVImport();
        });
    }

    const confirmCSVBtn = document.getElementById('confirm-import');
    if (confirmCSVBtn) {
        confirmCSVBtn.addEventListener('click', () => {
            this.handleConfirmCSVImport();
        });
    }

    const cancelCSVBtn = document.getElementById('cancel-import');
    if (cancelCSVBtn) {
        cancelCSVBtn.addEventListener('click', () => {
            this.hideCSVPreview();
        });
    }

    // JSON import handlers - FIXED
    const previewJSONBtn = document.getElementById('preview-json-import');
    if (previewJSONBtn) {
        previewJSONBtn.addEventListener('click', () => {
            this.handlePreviewJSONImport();
        });
    }

    const confirmJSONBtn = document.getElementById('confirm-json-import');
    if (confirmJSONBtn) {
        confirmJSONBtn.addEventListener('click', () => {
            this.handleConfirmJSONImport();
        });
    }

    const cancelJSONBtn = document.getElementById('cancel-json-import');
    if (cancelJSONBtn) {
        cancelJSONBtn.addEventListener('click', () => {
            this.hideJSONPreview();
        });
    }

    // Logbook actions
    const clearLogbookBtn = document.getElementById('clear-logbook');
    if (clearLogbookBtn) {
        clearLogbookBtn.addEventListener('click', () => {
            this.clearObservations();
        });
    }

    const downloadTemplateBtn = document.getElementById('download-template');
    if (downloadTemplateBtn) {
        downloadTemplateBtn.addEventListener('click', () => {
            this.downloadCSVTemplate();
        });
    }

    const importLogbookBtn = document.getElementById('import-logbook');
    if (importLogbookBtn) {
        importLogbookBtn.addEventListener('click', () => {
            this.switchTab('export');
            setTimeout(() => {
                // Scroll to import section
                const importSection = document.querySelector('.import-section');
                if (importSection) {
                    importSection.scrollIntoView({ behavior: 'smooth' });
                }
            }, 100);
        });
    }

    // Batch selection
    const enableBatchSelection = document.getElementById('enable-batch-selection');
    if (enableBatchSelection) {
        enableBatchSelection.addEventListener('change', (e) => {
            this.toggleBatchSelection(e.target.checked);
        });
    }

    const selectAllBtn = document.getElementById('select-all-btn');
    if (selectAllBtn) {
        selectAllBtn.addEventListener('click', () => {
            this.selectAllObservations();
        });
    }

    const deselectAllBtn = document.getElementById('deselect-all-btn');
    if (deselectAllBtn) {
        deselectAllBtn.addEventListener('click', () => {
            this.deselectAllObservations();
        });
    }

    const applyBatchBtn = document.getElementById('apply-batch-selection');
    if (applyBatchBtn) {
        applyBatchBtn.addEventListener('click', () => {
            this.applyBatchSelection();
        });
    }

    // File input change handlers - ADD THESE
    const csvImport = document.getElementById('csv-import');
    if (csvImport) {
        csvImport.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                const file = e.target.files[0];
                const MAX_FILE_SIZE = 10 * 1024 * 1024;
                if (file.size > MAX_FILE_SIZE) {
                    this.showStatus(`File too large. Maximum size is ${MAX_FILE_SIZE / 1024 / 1024}MB`, 'error', 'export');
                    e.target.value = '';
                    return;
                }
                // Don't auto-preview, let user click preview button
                this.hideCSVPreview();
                this.csvPreviewData = null;
                
                // Show file selected message
                this.showStatus(`CSV file selected: ${file.name} (${this.formatBytes(file.size)})`, 'info', 'export');
            }
        });
    }

    const jsonImport = document.getElementById('json-import');
    if (jsonImport) {
        jsonImport.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                const file = e.target.files[0];
                const MAX_FILE_SIZE = 10 * 1024 * 1024;
                if (file.size > MAX_FILE_SIZE) {
                    this.showStatus(`File too large. Maximum size is ${MAX_FILE_SIZE / 1024 / 1024}MB`, 'error', 'export');
                    e.target.value = '';
                    return;
                }
                // Don't auto-preview, let user click preview button
                this.hideJSONPreview();
                this.jsonPreviewData = null;
                
                // Show file selected message
                this.showStatus(`JSON file selected: ${file.name} (${this.formatBytes(file.size)})`, 'info', 'export');
            }
        });
    }

    // Form input tracking
    const recordPanel = document.getElementById('record-panel');
    if (recordPanel) {
        recordPanel.querySelectorAll('input, textarea, select').forEach(input => {
            input.addEventListener('input', () => {
                const recordStatus = document.getElementById('record-status');
                if (recordStatus) recordStatus.style.display = 'none';
            });
        });
    }

    // Touch event handling for mobile
    document.addEventListener('touchstart', function() {}, { passive: true });
},
```

Also, add this helper function to the EcoLens object (if it doesn't exist):

```javascript
// Format bytes for display
formatBytes(bytes, decimals = 1) {
    if (bytes === 0) return '0 Bytes';
    const k = 1024;
    const dm = decimals < 0 ? 0 : decimals;
    const sizes = ['Bytes', 'KB', 'MB', 'GB'];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];
},
```

Key fixes made:

1. Removed auto-click simulation for CSV import - this was causing conflicts
2. Added file selected feedback when user chooses a file
3. Ensured preview buttons are properly connected to their handlers
4. Fixed the file size validation to properly clear the input when file is too large
5. Added scrolling to import section when using the "Import CSV" button in logbook

Testing the fix:

1. For CSV import:
   · Go to Export tab
   · Click "Choose File" under "Import CSV File"
   · Select a CSV file
   · Click "Preview CSV Import" button
   · Preview should appear with validation results
2. For JSON import:
   · Go to Export tab
   · Click "Choose File" under "Import JSON File"
   · Select a JSON file
   · Click "Preview JSON Import" button
   · Preview should appear with validation results
3. For logbook import button:
   · Go to Logbook tab
   · Click "Import CSV" button
   · Should switch to Export tab and scroll to import section

The main issue was that the event listeners weren't properly attached and there was conflicting code trying to automatically trigger file dialogs. Now the user has full control and gets clear feedback at each step.
